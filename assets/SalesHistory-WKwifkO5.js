import{u as m,r,j as e,f as n,G as b}from"./index-B8t5lILS.js";const j=new b;function S(){const{withOverlay:c}=m(),[y,f]=r.useState([]),[i,h]=r.useState(0),[o,d]=r.useState(!1),[a,x]=r.useState({});async function u(){if(!(o||i===null)){d(!0);try{const t=await c(j.salesHistory(i,5),"Cargando...");t!=null&&t.ok&&(f(l=>[...l,...t.items]),h(t.next))}finally{d(!1)}}}r.useEffect(()=>{u()},[]);async function p(t){if(a[t]){const s={...a};delete s[t],x(s);return}const l=await c(j.salesHistoryDetails(t),"Cargando...");x(s=>({...s,[t]:(l==null?void 0:l.items)||[]}))}return e.jsxs("section",{children:[e.jsx("h2",{children:"Historial de ventas (últimas 5)"}),e.jsx("ul",{style:{listStyle:"none",padding:0},children:y.map((t,l)=>e.jsxs("li",{style:{border:"1px solid #ddd",borderRadius:6,padding:8,marginBottom:8},children:[e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("b",{children:new Date(t.date).toLocaleString()})," — ",t.ticket," — ",t.cliente,"  ",e.jsxs("span",{style:{opacity:.8},children:["Total: ",n.format(t.total||0)," | Desc: ",n.format(t.descuento||0)," | Entrega: ",n.format(t.entrega||0)," | A plazo: ",n.format(t.aplazo||0)," | Status: ",t.status]})]}),e.jsx("button",{onClick:()=>p(t.ticket),children:a[t.ticket]?"Ocultar":"Ver detalles"})]}),a[t.ticket]&&e.jsxs("table",{style:{marginTop:8,width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Producto"}),e.jsx("th",{children:"Cant"}),e.jsx("th",{style:{textAlign:"center"},children:"Total"}),e.jsx("th",{style:{textAlign:"center"},children:"Desc$"})]})}),e.jsx("tbody",{children:a[t.ticket].map((s,g)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.producto}),e.jsx("td",{children:s.qty}),e.jsx("td",{style:{textAlign:"right"},children:n.format(s.total||0)}),e.jsx("td",{style:{textAlign:"right"},children:n.format(s.desc||0)})]},g))})]})]},l))}),i!==null&&e.jsx("button",{disabled:o,onClick:u,children:o?"Cargando...":"Cargar más"})]})}export{S as default};
